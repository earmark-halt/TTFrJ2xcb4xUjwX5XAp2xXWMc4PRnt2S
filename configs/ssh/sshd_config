# === NETWORK ===
Port 34567
Protocol 2
AddressFamily inet
ListenAddress 0.0.0.0

# === AUTHENTICATION ===
HostKey /etc/ssh/ssh_host_ed25519_key
PubkeyAuthentication yes
AuthenticationMethods publickey
AuthorizedKeysFile .ssh/authorized_keys

PermitRootLogin no
PasswordAuthentication no
ChallengeResponseAuthentication no
PermitEmptyPasswords no
UsePAM no
AllowUsers user123

# === SESSION CONTROL ===
LoginGraceTime 20
ClientAliveInterval 300
ClientAliveCountMax 2
MaxAuthTries 3
MaxSessions 2
MaxStartups 2:30:10

# === SECURITY HARDENING ===
X11Forwarding no
AllowTcpForwarding no
PermitTunnel no
AllowAgentForwarding no
UseDNS no
Compression no

# === CRYPTOGRAPHY ===
KexAlgorithms sntrup761x25519-sha512@openssh.com
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com

# === LOGGING ===
LogLevel VERBOSE

# === PER-USER EXCEPTION ===
Match User user123
    AllowTcpForwarding yes
    PermitOpen 127.0.0.1:23456
